convnext-s4nd ================================
stem type:  new_s4nd_patch
INFO:src.models.sequence.kernels.ssm:CUDA extension for structured kernels (Cauchy and Vandermonde multiplication) found.
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (3, 64, [16, 16])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (3, 32, 16)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (3, 32, 16)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (96, 64, [56, 56])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (96, 64, [56, 56])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (96, 64, [56, 56])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (96, 32, 56)
strided conv downsample
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (192, 64, [28, 28])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (192, 64, [28, 28])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (192, 64, [28, 28])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (192, 32, 28)
strided conv downsample
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (384, 64, [14, 14])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (384, 32, 14)
strided conv downsample
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (768, 64, [7, 7])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (768, 64, [7, 7])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
INFO:src.models.sequence.modules.s4nd:Constructing S4ND (H, N, L) = (768, 64, [7, 7])
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
INFO:src.models.sequence.kernels.ssm:Constructing S4 (H, N, L) = (768, 32, 7)
30007057
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 16
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 16
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 56
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 28
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 14
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:src.models.sequence.kernels.ssm:S4: Initializing kernel to length 7
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 684.4703490392949
INFO:root:batch_size 128 mem cost 3945.23486328125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 969.148069261828
INFO:root:batch_size 128 mem cost 3945.23486328125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 331.03009704884664
INFO:root:batch_size 128 mem cost 18780.6455078125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 234.53354252367774
INFO:root:batch_size 128 mem cost 24571.91455078125 MB
vim ================================
25796584
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 810.7858615488122
INFO:root:batch_size 128 mem cost 1054.6875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1272.2677570829862
INFO:root:batch_size 128 mem cost 722.5107421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 343.3715898477767
INFO:root:batch_size 128 mem cost 9057.921875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 231.86611909111733
INFO:root:batch_size 128 mem cost 16142.8525390625 MB
swin ================================
/home/zjy/miniconda3/envs/cu12/lib/python3.10/site-packages/torch/functional.py:507: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3549.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
28288354
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1247.288749011648
INFO:root:batch_size 128 mem cost 2264.29833984375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 3130.2023187724167
INFO:root:batch_size 128 mem cost 1600.16455078125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 985.0920144874538
INFO:root:batch_size 128 mem cost 8969.23681640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 365.13993901308936
INFO:root:batch_size 128 mem cost 13428.9677734375 MB
49606258
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 718.7236361684256
INFO:root:batch_size 128 mem cost 2345.75341796875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1982.8211877775664
INFO:root:batch_size 128 mem cost 1683.61962890625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 640.3699850870437
INFO:root:batch_size 128 mem cost 14203.26025390625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 209.37197172863756
INFO:root:batch_size 128 mem cost 21378.7431640625 MB
87768224
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 457.4244955213736
INFO:root:batch_size 128 mem cost 3174.32568359375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1501.550050557814
INFO:root:batch_size 128 mem cost 2292.96826171875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 494.27328683612666
INFO:root:batch_size 128 mem cost 19075.31982421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 134.10959096648403
INFO:root:batch_size 128 mem cost 28618.576171875 MB
convnext ================================
28589128
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1189.2529304485995
INFO:root:batch_size 128 mem cost 1672.69189453125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 2410.3968847370675
INFO:root:batch_size 128 mem cost 1085.0859375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 700.7073041785249
INFO:root:batch_size 128 mem cost 8626.0341796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 368.350556814205
INFO:root:batch_size 128 mem cost 14551.24560546875 MB
50223688
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 681.8784862857607
INFO:root:batch_size 128 mem cost 1756.47119140625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1532.0104867599994
INFO:root:batch_size 128 mem cost 1168.865234375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 444.1152141457491
INFO:root:batch_size 128 mem cost 13163.4638671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 209.14168611301486
INFO:root:batch_size 128 mem cost 22707.56201171875 MB
88591464
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 435.5101138893477
INFO:root:batch_size 128 mem cost 2388.53759765625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1144.8618641894363
INFO:root:batch_size 128 mem cost 1605.216796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 333.7715480511178
INFO:root:batch_size 128 mem cost 17709.03466796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 133.19394164712548
INFO:root:batch_size 128 mem cost 30393.16259765625 MB
hivit ================================
19181668
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1391.0317044935168
INFO:root:batch_size 128 mem cost 1347.27490234375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 3916.0693148027026
INFO:root:batch_size 128 mem cost 904.44482421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 1300.1537117294797
INFO:root:batch_size 128 mem cost 7985.25341796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 446.04485083149626
INFO:root:batch_size 128 mem cost 11680.712890625 MB
37526464
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 711.3081045157992
INFO:root:batch_size 128 mem cost 1419.69677734375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 2069.873865408114
INFO:root:batch_size 128 mem cost 978.08056640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 697.0671415422461
INFO:root:batch_size 128 mem cost 15180.27197265625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 229.6537866075201
INFO:root:batch_size 128 mem cost 22404.1904296875 MB
66418952
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 455.7709011229177
INFO:root:batch_size 128 mem cost 1920.28271484375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1583.717101944517
INFO:root:batch_size 128 mem cost 1332.95654296875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 541.9223144051879
INFO:root:batch_size 128 mem cost 20317.056640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 146.55794214694185
INFO:root:batch_size 128 mem cost 29870.02685546875 MB
intern ================================
using core type: DCNv3
using activation layer: GELU
using main norm layer: LN
using dpr: linear, 0.2
level2_post_norm: False
level2_post_norm_block_ids: None
res_post_norm: False
remove_center: False
22195704
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 980.5853048283551
INFO:root:batch_size 128 mem cost 1351.578125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1942.2024324247084
INFO:root:batch_size 128 mem cost 959.96923828125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 483.380276211858
INFO:root:batch_size 128 mem cost 12346.14013671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 296.0068513667915
INFO:root:batch_size 128 mem cost 17263.87548828125 MB
using core type: DCNv3
using activation layer: GELU
using main norm layer: LN
using dpr: linear, 0.2
level2_post_norm: False
level2_post_norm_block_ids: None
res_post_norm: False
remove_center: False
50079880
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 559.6994869126016
INFO:root:batch_size 128 mem cost 1633.05712890625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1159.814269880151
INFO:root:batch_size 128 mem cost 1157.31005859375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 282.3477359926145
INFO:root:batch_size 128 mem cost 23337.29150390625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 156.32379046224324
INFO:root:batch_size 128 mem cost 31789.90771484375 MB
using core type: DCNv3
using activation layer: GELU
using main norm layer: LN
using dpr: linear, 0.2
level2_post_norm: False
level2_post_norm_block_ids: None
res_post_norm: False
remove_center: False
97461832
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 369.3696623312362
INFO:root:batch_size 128 mem cost 2352.048828125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 882.0642615919255
INFO:root:batch_size 128 mem cost 1680.30224609375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 219.58238013802142
INFO:root:batch_size 128 mem cost 32799.34716796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 101.87264527315865
INFO:root:batch_size 128 mem cost 44529.5810546875 MB
vssm ================================
vmamba v0-6 ================================
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 425.83191791476526
INFO:root:batch_size 128 mem cost 7512.44482421875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 504.0366854188779
INFO:root:batch_size 128 mem cost 6811.3916015625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 137.50429492626398
INFO:root:batch_size 128 mem cost 28583.0 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 84.56182366269036
INFO:root:batch_size 128 mem cost 37525.94921875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 433.98571582314065
INFO:root:batch_size 128 mem cost 6503.69482421875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 516.6680378289374
INFO:root:batch_size 128 mem cost 6093.6416015625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 157.20533485838027
INFO:root:batch_size 128 mem cost 27880.70703125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 91.1766545771281
INFO:root:batch_size 128 mem cost 37615.66748046875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 466.5174927035167
INFO:root:batch_size 128 mem cost 6083.32763671875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 562.449012004626
INFO:root:batch_size 128 mem cost 5673.2744140625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 165.0188429516533
INFO:root:batch_size 128 mem cost 28041.45703125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 93.99212228991549
INFO:root:batch_size 128 mem cost 37777.44482421875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 462.9687664699204
INFO:root:batch_size 128 mem cost 6249.11279296875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 557.1232329135813
INFO:root:batch_size 128 mem cost 5839.0595703125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 177.4648149532394
INFO:root:batch_size 128 mem cost 28205.6796875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 97.91768651797805
INFO:root:batch_size 128 mem cost 37943.08154296875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 463.05407305248434
INFO:root:batch_size 128 mem cost 5756.94482421875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 612.6489500966647
INFO:root:batch_size 128 mem cost 4071.8916015625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 184.26902066629486
INFO:root:batch_size 128 mem cost 20810.84765625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 97.93009817515035
INFO:root:batch_size 128 mem cost 37464.01123046875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 553.8035858584591
INFO:root:batch_size 128 mem cost 5919.87451171875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 703.5314966323926
INFO:root:batch_size 128 mem cost 4235.6923828125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 199.57696313202254
INFO:root:batch_size 128 mem cost 17423.484375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 159.11001677162005
INFO:root:batch_size 128 mem cost 30531.13623046875 MB
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 636.5530635662333
INFO:root:batch_size 128 mem cost 6378.70263671875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 701.1952772916749
INFO:root:batch_size 128 mem cost 4694.3447265625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 194.79931499300875
INFO:root:batch_size 128 mem cost 16777.11181640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 169.34771290761614
INFO:root:batch_size 128 mem cost 29069.44873046875 MB
vmamba a7-a9v3 ================================
28991656
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 811.0378099956774
INFO:root:batch_size 128 mem cost 6566.7890625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 897.3689268659023
INFO:root:batch_size 128 mem cost 4882.49853515625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 248.36081937204008
INFO:root:batch_size 128 mem cost 15131.96630859375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 223.45788618696966
INFO:root:batch_size 128 mem cost 25622.73388671875 MB
28256680
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1137.1805798261835
INFO:root:batch_size 128 mem cost 4161.96630859375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1247.5688332101345
INFO:root:batch_size 128 mem cost 3212.86328125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 350.4422554560236
INFO:root:batch_size 128 mem cost 12601.39990234375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 319.0410762038421
INFO:root:batch_size 128 mem cost 20816.13037109375 MB
31795452
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1298.1448555714444
INFO:root:batch_size 128 mem cost 5356.234375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1417.6683562482804
INFO:root:batch_size 128 mem cost 4153.30322265625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 449.3454693035387
INFO:root:batch_size 128 mem cost 15166.44873046875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 388.0486808593478
INFO:root:batch_size 128 mem cost 25674.75048828125 MB
31872804
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1245.1663682496683
INFO:root:batch_size 128 mem cost 5474.98779296875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1361.99372114528
INFO:root:batch_size 128 mem cost 4259.041015625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 425.75622838688304
INFO:root:batch_size 128 mem cost 15301.39453125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 370.70169160022067
INFO:root:batch_size 128 mem cost 25827.05810546875 MB
32027508
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1149.034205363449
INFO:root:batch_size 128 mem cost 5615.90380859375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1252.4353796744238
INFO:root:batch_size 128 mem cost 4376.10546875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 385.60905182438376
INFO:root:batch_size 128 mem cost 15477.8134765625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 337.63393643258127
INFO:root:batch_size 128 mem cost 26044.13818359375 MB
32336916
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 981.5282284640326
INFO:root:batch_size 128 mem cost 5807.86376953125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1079.292915274702
INFO:root:batch_size 128 mem cost 4518.4169921875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 320.0672863315875
INFO:root:batch_size 128 mem cost 15757.57958984375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 286.19702460510865
INFO:root:batch_size 128 mem cost 26382.67431640625 MB
vmamba aa-acv4 ================================
31795452
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1298.663293684342
INFO:root:batch_size 128 mem cost 5729.9912109375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1418.7574316588646
INFO:root:batch_size 128 mem cost 4526.67724609375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 449.33278291944094
INFO:root:batch_size 128 mem cost 15530.63232421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 388.04502529898156
INFO:root:batch_size 128 mem cost 26037.89111328125 MB
30705832
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1336.3289477210444
INFO:root:batch_size 128 mem cost 6535.91748046875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1498.058367635275
INFO:root:batch_size 128 mem cost 5181.8095703125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 463.39749388123636
INFO:root:batch_size 128 mem cost 16298.0576171875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 352.39818921362
INFO:root:batch_size 128 mem cost 27216.75830078125 MB
30713896
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1310.3591393776323
INFO:root:batch_size 128 mem cost 6618.12841796875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1470.0090193184271
INFO:root:batch_size 128 mem cost 5263.876953125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 458.4230139626075
INFO:root:batch_size 128 mem cost 16379.32763671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 349.6089572466748
INFO:root:batch_size 128 mem cost 27300.09814453125 MB
29722024
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1472.1121553037708
INFO:root:batch_size 128 mem cost 6669.43994140625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1649.702266228047
INFO:root:batch_size 128 mem cost 5329.6806640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 521.0394917702065
INFO:root:batch_size 128 mem cost 15127.98388671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 462.9725459681162
INFO:root:batch_size 128 mem cost 24721.82275390625 MB
32610088
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1458.044953344922
INFO:root:batch_size 128 mem cost 7042.12841796875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1645.5462008525183
INFO:root:batch_size 128 mem cost 5559.423828125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 538.7051851987623
INFO:root:batch_size 128 mem cost 15150.03857421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 483.70072274034925
INFO:root:batch_size 128 mem cost 24656.73486328125 MB
30098728
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1471.3258490522603
INFO:root:batch_size 128 mem cost 6874.34912109375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1650.3277072420083
INFO:root:batch_size 128 mem cost 5520.80859375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 521.0804209413919
INFO:root:batch_size 128 mem cost 13863.75732421875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 462.2364173350545
INFO:root:batch_size 128 mem cost 23461.53271484375 MB
30169964
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1465.162801351658
INFO:root:batch_size 128 mem cost 4742.234375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1615.4250873351714
INFO:root:batch_size 128 mem cost 3557.47119140625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 552.3513692382434
INFO:root:batch_size 128 mem cost 12386.7763671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 503.653723385343
INFO:root:batch_size 128 mem cost 20703.32373046875 MB
29722024
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1444.6036515553135
INFO:root:batch_size 128 mem cost 5547.87353515625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1627.3832458248744
INFO:root:batch_size 128 mem cost 4208.1142578125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 515.9191762912252
INFO:root:batch_size 128 mem cost 14680.27001953125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 455.80076055242864
INFO:root:batch_size 128 mem cost 24938.74169921875 MB
32610088
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1431.7094703463542
INFO:root:batch_size 128 mem cost 5919.55224609375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1624.9819640131793
INFO:root:batch_size 128 mem cost 4438.13671875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 533.3469464986312
INFO:root:batch_size 128 mem cost 14703.28759765625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 476.1214916692109
INFO:root:batch_size 128 mem cost 24874.59326171875 MB
30098728
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1444.9662809476342
INFO:root:batch_size 128 mem cost 5754.96630859375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1628.8152348945166
INFO:root:batch_size 128 mem cost 4401.42578125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 516.09818374674
INFO:root:batch_size 128 mem cost 14860.99169921875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 455.5312130454781
INFO:root:batch_size 128 mem cost 25119.34326171875 MB
30169964
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1445.4565994901723
INFO:root:batch_size 128 mem cost 5078.572265625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1598.95999524267
INFO:root:batch_size 128 mem cost 3894.83447265625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 547.9473386830751
INFO:root:batch_size 128 mem cost 13249.5947265625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 497.7195613180335
INFO:root:batch_size 128 mem cost 22102.27294921875 MB
vmamba v0 ================================
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 425.7855599509047
INFO:root:batch_size 128 mem cost 7512.44482421875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 503.90423705149834
INFO:root:batch_size 128 mem cost 6811.3916015625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 137.626792978341
INFO:root:batch_size 128 mem cost 28583.56640625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 84.56850289131576
INFO:root:batch_size 128 mem cost 37521.57421875 MB
44417416
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 233.95188749062933
INFO:root:batch_size 128 mem cost 7766.36474609375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 285.6558170103235
INFO:root:batch_size 128 mem cost 7062.3115234375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 80.2952672830133
INFO:root:batch_size 128 mem cost 51115.6123046875 MB
batch_size 64
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 82.28770728753813
INFO:root:batch_size 64 mem cost 25949.40185546875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 51.96162339577822
INFO:root:batch_size 64 mem cost 33941.63330078125 MB
76254056
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 167.76220261426568
INFO:root:batch_size 128 mem cost 10375.62060546875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 216.6388740441605
INFO:root:batch_size 128 mem cost 9469.642578125 MB
batch_size 64
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 63.067541160819204
INFO:root:batch_size 64 mem cost 34505.05419921875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 40.37720788264965
INFO:root:batch_size 64 mem cost 45120.58251953125 MB
vmamba v0+ ================================
22893448
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 637.4549750026696
INFO:root:batch_size 128 mem cost 6545.32373046875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 701.9590744446859
INFO:root:batch_size 128 mem cost 4861.2861328125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 194.86400049750057
INFO:root:batch_size 128 mem cost 16942.30908203125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 169.31645303905597
INFO:root:batch_size 128 mem cost 29243.13232421875 MB
44417416
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 356.47641454404305
INFO:root:batch_size 128 mem cost 6794.68896484375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 393.17945619653955
INFO:root:batch_size 128 mem cost 5110.3310546875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 110.6462395511027
INFO:root:batch_size 128 mem cost 29996.34326171875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 98.12802597607309
INFO:root:batch_size 128 mem cost 52049.14306640625 MB
76254056
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 267.93256889589645
INFO:root:batch_size 128 mem cost 9079.04443359375 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 297.7211381316263
INFO:root:batch_size 128 mem cost 6899.09765625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 84.01741847907452
INFO:root:batch_size 128 mem cost 40021.70654296875 MB
batch_size 64
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 83.03334313475787
INFO:root:batch_size 64 mem cost 19989.087890625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 74.19528265092701
INFO:root:batch_size 64 mem cost 34551.27734375 MB
vmamba v2 ================================
30705832
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 645.1151999771212
INFO:root:batch_size 128 mem cost 6612.51904296875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1048.3915759089775
INFO:root:batch_size 128 mem cost 5259.2724609375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 381.5096158802252
INFO:root:batch_size 128 mem cost 18718.11083984375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 133.9949624914826
INFO:root:batch_size 128 mem cost 32294.3642578125 MB
50147752
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 402.0214173931022
INFO:root:batch_size 128 mem cost 6774.39892578125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 694.1535698976431
INFO:root:batch_size 128 mem cost 5421.15234375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 256.079472091875
INFO:root:batch_size 128 mem cost 27949.28369140625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 93.32572803618001
INFO:root:batch_size 128 mem cost 48899.9814453125 MB
88557800
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 276.94953079212166
INFO:root:batch_size 128 mem cost 8904.0625 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 528.4182630091375
INFO:root:batch_size 128 mem cost 7103.9755859375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 197.16232408839986
INFO:root:batch_size 128 mem cost 37140.25732421875 MB
batch_size 64
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 191.61888240794573
INFO:root:batch_size 64 mem cost 19592.71826171875 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 64 testfwdbwd 71.63587140252089
INFO:root:batch_size 64 mem cost 33451.85107421875 MB
vmamba v2+ ================================
30705832
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1334.8457509500527
INFO:root:batch_size 128 mem cost 5988.80419921875 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1498.8239973355278
INFO:root:batch_size 128 mem cost 4635.2705078125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 463.5325929245846
INFO:root:batch_size 128 mem cost 15760.58984375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 352.39345509926756
INFO:root:batch_size 128 mem cost 26687.40966796875 MB
50147752
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 873.5922811198382
INFO:root:batch_size 128 mem cost 6152.64501953125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 1005.411071357341
INFO:root:batch_size 128 mem cost 4798.111328125 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 313.128902694845
INFO:root:batch_size 128 mem cost 23504.7021484375 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 235.51504866529197
INFO:root:batch_size 128 mem cost 40324.44091796875 MB
88557800
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 645.4067749623903
INFO:root:batch_size 128 mem cost 8184.033203125 MB
INFO:root:throughput averaged with 30 times
INFO:root:batch_size 128 throughput 767.0878643954073
INFO:root:batch_size 128 mem cost 6384.1259765625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 246.43326940950368
INFO:root:batch_size 128 mem cost 31312.47119140625 MB
INFO:root:testfwdbwd averaged with 30 times
INFO:root:batch_size 128 testfwdbwd 179.7888817898678
INFO:root:batch_size 128 mem cost 52895.50048828125 MB
